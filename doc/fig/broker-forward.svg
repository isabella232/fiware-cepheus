<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1038" height="590"><source><![CDATA[participant IoT Agent as D
participant Cepheus Broker as B
participant Orion Broker as A

D->B: register
B->A: register (forward)
Note right of A: Third app issues a command
A->B: update (command)
B->D: update (forward)
Note right of A: Third app issues a query
A->B: query (lazy)
B->D: query (forward)
Note left of D: Device pushes an update
D->B: update (active)
B->A: update(forward)]]></source><desc>Created with RaphaÃ«l 2.1.2</desc><defs><path id="raphael-marker-block" stroke-linecap="round" d="M5,0 0,2.5 5,5z"/><marker id="raphael-marker-endblock55-obj213" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker><marker id="raphael-marker-endblock55-obj216" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker><marker id="raphael-marker-endblock55-obj222" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker><marker id="raphael-marker-endblock55-obj225" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker><marker id="raphael-marker-endblock55-obj231" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker><marker id="raphael-marker-endblock55-obj234" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker><marker id="raphael-marker-endblock55-obj240" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker><marker id="raphael-marker-endblock55-obj243" markerHeight="5" markerWidth="5" orient="auto" refX="2.5" refY="2.5"><use fill="#000" stroke="none" stroke-width="1" transform="rotate(180 2.5 2.5) scale(1,1)" xlink:href="#raphael-marker-block"/></marker></defs><rect width="107.4" height="38.5" x="218.1" y="20" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="87.4" height="18.5" x="228.1" y="30" fill="#fff" stroke="none" rx="0" ry="0"/><text x="271.8" y="39.25" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">IoT Agent</tspan></text><rect width="107.4" height="38.5" x="218.1" y="532" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="87.4" height="18.5" x="228.1" y="542" fill="#fff" stroke="none" rx="0" ry="0"/><text x="271.8" y="551.25" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">IoT Agent</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M271.8000030517578,58.5L271.8000030517578,532"/><rect width="155.4" height="38.5" x="368.7" y="20" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="135.4" height="18.5" x="378.7" y="30" fill="#fff" stroke="none" rx="0" ry="0"/><text x="446.4" y="39.25" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">Cepheus Broker</tspan></text><rect width="155.4" height="38.5" x="368.7" y="532" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="135.4" height="18.5" x="378.7" y="542" fill="#fff" stroke="none" rx="0" ry="0"/><text x="446.4" y="551.25" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">Cepheus Broker</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M446.40000915527344,58.5L446.40000915527344,532"/><rect width="136.2" height="38.5" x="572.1" y="20" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="116.2" height="18.5" x="582.1" y="30" fill="#fff" stroke="none" rx="0" ry="0"/><text x="640.2" y="39.25" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">Orion Broker</tspan></text><rect width="136.2" height="38.5" x="572.1" y="532" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="116.2" height="18.5" x="582.1" y="542" fill="#fff" stroke="none" rx="0" ry="0"/><text x="640.2" y="551.25" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">Orion Broker</tspan></text><path fill="none" stroke="#000" stroke-width="2" d="M640.2000122070312,58.5L640.2000122070312,532"/><rect width="77.8" height="18.5" x="320.2" y="74.25" fill="#fff" stroke="none" rx="0" ry="0"/><text x="359.1" y="83.5" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">register</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj213)" d="M271.8000030517578,97C271.8000030517578,97,412.8886039940189,97,441.409444223558,97"/><rect width="173.8" height="18.5" x="456.4" y="112.75" fill="#fff" stroke="none" rx="0" ry="0"/><text x="543.3" y="122" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">register (forward)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj216)" d="M446.40000915527344,135.5C446.40000915527344,135.5,604.7949506072009,135.5,635.1900736494897,135.5"/><rect width="260.6" height="28.5" x="660.2" y="155.5" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="250.6" height="18.5" x="665.2" y="160.5" fill="#fff" stroke="none" rx="0" ry="0"/><text x="790.5" y="169.75" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">Third app issues a command</tspan></text><rect width="154.6" height="18.5" x="466" y="199.75" fill="#fff" stroke="none" rx="0" ry="0"/><text x="543.3" y="209" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">update (command)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj222)" d="M640.2000122070312,222.5C640.2000122070312,222.5,481.80507075510377,222.5,451.4099477128149,222.5"/><rect width="154.6" height="18.5" x="281.8" y="238.25" fill="#fff" stroke="none" rx="0" ry="0"/><text x="359.1" y="247.5" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">update (forward)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj225)" d="M446.40000915527344,261C446.40000915527344,261,305.3114082130123,261,276.79056798347324,261"/><rect width="241.4" height="28.5" x="660.2" y="281" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="231.4" height="18.5" x="665.2" y="286" fill="#fff" stroke="none" rx="0" ry="0"/><text x="780.9" y="295.25" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">Third app issues a query</tspan></text><rect width="116.2" height="18.5" x="485.2" y="325.25" fill="#fff" stroke="none" rx="0" ry="0"/><text x="543.3" y="334.5" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">query (lazy)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj231)" d="M640.2000122070312,348C640.2000122070312,348,481.80507075510377,348,451.4099477128149,348"/><rect width="145" height="18.5" x="286.6" y="363.75" fill="#fff" stroke="none" rx="0" ry="0"/><text x="359.1" y="373" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">query (forward)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj234)" d="M446.40000915527344,386.5C446.40000915527344,386.5,305.3114082130123,386.5,276.79056798347324,386.5"/><rect width="231.8" height="28.5" x="20" y="406.5" fill="none" stroke="#000" stroke-width="2" rx="0" ry="0"/><rect width="221.8" height="18.5" x="25" y="411.5" fill="#fff" stroke="none" rx="0" ry="0"/><text x="135.9" y="420.75" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">Device pushes an update</tspan></text><rect width="145" height="18.5" x="286.6" y="450.75" fill="#fff" stroke="none" rx="0" ry="0"/><text x="359.1" y="460" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">update (active)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj240)" d="M271.8000030517578,473.5C271.8000030517578,473.5,412.8886039940189,473.5,441.409444223558,473.5"/><rect width="145" height="18.5" x="470.8" y="489.25" fill="#fff" stroke="none" rx="0" ry="0"/><text x="543.3" y="498.5" fill="#000" stroke="none" font-family="Andale Mono, monospace" font-size="16" text-anchor="middle" style="text-anchor:middle;font-family:Andale Mono,monospace;font-size:16px"><tspan dy="5.75">update(forward)</tspan></text><path fill="none" stroke="#000" stroke-dasharray="0" stroke-width="2" marker-end="url(#raphael-marker-endblock55-obj243)" d="M446.40000915527344,512C446.40000915527344,512,604.7949506072009,512,635.1900736494897,512"/></svg>